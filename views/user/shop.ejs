<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %></title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/shop.css">
</head>
<body>
  <!-- Header -->
  <header class="header animate-slide-down">
    <div class="container">
      <div class="header-content">
        <a href="/" class="logo animate-fade-in">
          <span class="logo-text">ShadElectro</span>
          <div class="logo-underline"></div>
        </a>
        
        <form action="/shop" method="GET" class="search-form animate-fade-in-up">
          <div class="search-container">
            <input 
              type="text" 
              name="search" 
              class="search-input" 
              placeholder="Search for products..." 
              value="<%= search %>"
            >
            <button type="submit" class="search-button">
              <i class="fas fa-search"></i>
              <span class="search-ripple"></span>
            </button>
          </div>
          
          <!-- Preserve other filter parameters when searching -->
          <% if (selectedCategory) { %>
            <input type="hidden" name="category" value="<%= selectedCategory %>">
          <% } %>
          <% if (priceRange) { %>
            <input type="hidden" name="priceRange" value="<%= priceRange %>">
          <% } %>
          <% if (sort) { %>
            <input type="hidden" name="sort" value="<%= sort %>">
          <% } %>
          <% if (currentPage) { %>
            <input type="hidden" name="page" value="<%= currentPage %>">
          <% } %>
        </form>
        
        <div class="user-actions animate-slide-in-right">
          <a href="/wishlist" class="action-link wishlist-link">
            <i class="fas fa-heart"></i>
            <span class="action-tooltip">Wishlist</span>
            <span class="wishlist-count">0</span>
          </a>
          
          <a href="/cart" class="action-link cart-link">
            <i class="fas fa-shopping-cart"></i>
            <span class="action-tooltip">Cart</span>
            <span class="cart-count">0</span>
          </a>

          <% if(user) { %>
            <div class="dropdown">
              <a href="#" class="action-link account-link">
                <i class="fas fa-user"></i>
                <span class="action-tooltip">Account</span>
              </a>
              <div class="dropdown-content">
                <a href="/profile" class="dropdown-item">
                  <i class="fas fa-user-circle"></i>
                  <span>Profile</span>
                </a>
                <a href="/logout" class="dropdown-item">
                  <i class="fas fa-sign-out-alt"></i>
                  <span>Logout</span>
                </a>
              </div>
            </div>
          <% } else { %>
            <a href="/login" class="action-link login-link">
              <i class="fas fa-sign-in-alt"></i>
              <span>Log In</span>
            </a>
          <% } %>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Navigation -->
  <nav class="main-nav animate-slide-down">
    <div class="container">
      <ul class="nav-list">
        <li><a href="/" class="nav-link">
          <span>Home</span>
          <div class="nav-underline"></div>
        </a></li>
        <li><a href="/shop" class="nav-link <%= !selectedCategory ? 'active' : '' %>">
          <span>Shop</span>
          <div class="nav-underline"></div>
        </a></li>
        <li><a href="/contact" class="nav-link">
          <span>Contact</span>
          <div class="nav-underline"></div>
        </a></li>
        <li><a href="/about" class="nav-link">
          <span>About</span>
          <div class="nav-underline"></div>
        </a></li>
        <li><a href="/help" class="nav-link special-link">
          <span>Help</span>
          <div class="nav-underline"></div>
        </a></li>
      </ul>
    </div>
  </nav>

  <!-- Breadcrumb -->
  <div class="container">
    <div class="breadcrumb animate-fade-in-up">
      <a href="/" class="breadcrumb-link">
        <i class="fas fa-home"></i>
        <span>Home</span>
      </a>
      <span class="breadcrumb-separator">
        <i class="fas fa-chevron-right"></i>
      </span>
      <% if (selectedCategoryName) { %>
        <a href="/shop" class="breadcrumb-link">All Products</a>
        <span class="breadcrumb-separator">
          <i class="fas fa-chevron-right"></i>
        </span>
        <span class="breadcrumb-current"><%= selectedCategoryName %></span>
      <% } else { %>
        <span class="breadcrumb-current">All Products</span>
      <% } %>
    </div>
  </div>

  <!-- Main Content -->
  <main class="container">
    <div class="shop-layout">
      <!-- Sidebar -->
      <aside class="sidebar animate-slide-in-left">
        <div class="sidebar-header">
          <h2 class="sidebar-heading">
            <i class="fas fa-filter"></i>
            <% if (selectedCategoryName) { %>
              Browse by
            <% } else { %>
              Filter by
            <% } %>
          </h2>
        </div>

        <form id="filter-form" action="/shop" method="GET">
          <!-- Preserve search parameter -->
          <% if (search) { %>
            <input type="hidden" name="search" value="<%= search %>">
          <% } %>
          
          <!-- Categories -->
          <div class="sidebar-section animate-fade-in-up" style="animation-delay: 0.1s">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-tags"></i>
                <span>Categories</span>
              </h3>
            </div>
            <ul class="category-list">
              <li class="category-item">
                <a href="/shop" class="category-link <%= !selectedCategory ? 'active' : '' %>">
                  <span class="category-icon">
                    <i class="fas fa-th-large"></i>
                  </span>
                  <span>All Products</span>
                  <span class="category-arrow">
                    <i class="fas fa-chevron-right"></i>
                  </span>
                </a>
              </li>
              <% categories.forEach((category, index) => { %>
                <li class="category-item" style="animation-delay: <%= (index + 1) * 0.05 %>s">
                  <a 
                    href="/shop?category=<%= category._id %>" 
                    class="category-link <%= selectedCategory === category._id.toString() ? 'active' : '' %>"
                  >
                    <span class="category-icon">
                      <i class="fas fa-cube"></i>
                    </span>
                    <span><%= category.name %></span>
                    <span class="category-arrow">
                      <i class="fas fa-chevron-right"></i>
                    </span>
                  </a>
                </li>
              <% }); %>
            </ul>
          </div>

          <!-- Price Filter -->
          <div class="sidebar-section animate-fade-in-up" style="animation-delay: 0.2s">
            <div class="section-header">
              <h3 class="section-title">
                <i class="fas fa-dollar-sign"></i>
                <span>Price Range</span>
              </h3>
              <span class="toggle-icon" onclick="toggleSection(this)">
                <i class="fas fa-minus"></i>
              </span>
            </div>
            
            <div class="price-range" id="priceRangeSection">
              <div class="price-slider-container">
                <input 
                  type="range" 
                  id="price-slider" 
                  class="price-slider" 
                  min="100" 
                  max="2000" 
                  step="5" 
                  value="<%= priceRange ? priceRange.split('-')[1] : 2000 %>"
                >
                <div class="slider-track"></div>
                <div class="slider-fill"></div>
              </div>
              
              <% const sliderange = priceRange ? priceRange.split('-')[1] : '2000' %>
              <div class="price-inputs">
                <div class="price-input-group">
                  <span class="price-label">Min</span>
                  <span class="price-value">₹100</span>
                </div>
                <div class="price-input-group">
                  <span class="price-label">Max</span>
                  <span class="price-value" id="dynamic-price">₹<%= sliderange %></span>
                </div>
              </div>
              
              <!-- Hidden input to store the price range value -->
              <input 
                type="hidden" 
                name="priceRange" 
                id="price-range-input" 
                value="<%= priceRange || '100-2000' %>" 
              >
              
              <!-- If category is selected, preserve it -->
              <% if (selectedCategory) { %>
                <input type="hidden" name="category" value="<%= selectedCategory %>">
              <% } %>
              
              <!-- Preserve sort parameter -->
              <% if (sort) { %>
                <input type="hidden" name="sort" value="<%= sort %>">
              <% } %>
            </div>
          </div>
        </form>
      </aside>

      <!-- Main Content -->
      <div class="main-content animate-slide-in-right">
        <div class="shop-header animate-fade-in-up">
          <div class="header-left">
            <h1 class="shop-title">
              <% if (selectedCategoryName) { %>
                <%= selectedCategoryName %>
              <% } else { %>
                All Products
              <% } %>
            </h1>
            <p class="product-count">
              <span class="count-number"><%= totalProducts %></span>
              <span class="count-text">products found</span>
              <% if (totalPages > 1) { %>
                <span class="page-info">
                  (Page <%= currentPage %> of <%= totalPages %>)
                </span>
              <% } %>
            </p>
          </div>
          
          <div class="sort-control">
            <label for="sort-select" class="sort-label">
              <i class="fas fa-sort"></i>
              <span>Sort by:</span>
            </label>
            <div class="select-wrapper">
              <select id="sort-select" class="sort-select" onchange="updateSort(this.value)">
                <option value="recommended" <%= sort === 'recommended' ? 'selected' : '' %>>Recommended</option>
                <option value="price_asc" <%= sort === 'price_asc' ? 'selected' : '' %>>Price: Low to High</option>
                <option value="price_desc" <%= sort === 'price_desc' ? 'selected' : '' %>>Price: High to Low</option>
                <option value="name_asc" <%= sort === 'name_asc' ? 'selected' : '' %>>Name: A to Z</option>
                <option value="name_desc" <%= sort === 'name_desc' ? 'selected' : '' %>>Name: Z to A</option>
              </select>
              <i class="fas fa-chevron-down select-arrow"></i>
            </div>
          </div>
        </div>

        <!-- Product Grid -->
        <div class="product-grid" id="productGrid">
          <% if (products.length === 0) { %>
            <div class="no-products animate-fade-in-up">
              <div class="no-products-icon">
                <i class="fas fa-search"></i>
              </div>
              <h3>No products found</h3>
              <p>Try adjusting your filters or search terms</p>
              <a href="/shop" class="btn btn-primary">
                <span>View All Products</span>
                <i class="fas fa-arrow-right"></i>
              </a>
            </div>
          <% } else { %>
            <% products.forEach((product, index) => { %>
              <div class="product-card animate-fade-in-up" style="animation-delay: <%= index * 0.05 %>s">
                <% 
                  const variant = product.variants && product.variants[0];
                  const hasSale = variant && variant.salesPrice && variant.regularPrice && variant.salesPrice < variant.regularPrice;
                %>
                
                <% if (variant.appliedOffer) { %>
                  <div class="sale-badge pulse-animation">
                    <span>SALE</span>
                  </div>
                <% } %>
                
                <div class="product-image-container">
                  <a href="/shop/<%= product._id %>" class="product-link">
                    <div class="product-image">
                      <% if (variant && variant.productImage && variant.productImage[0]) { %>
                        <img src="/uploads/productImages/<%= variant.productImage[0] %>" alt="<%= product.productName %>" loading="lazy">
                      <% } else { %>
                        <img src="/images/placeholder.jpg" alt="<%= product.productName %>" loading="lazy">
                      <% } %>
                      <div class="image-overlay">
                        <div class="overlay-content">
                          <i class="fas fa-eye"></i>
                          <span>Quick View</span>
                        </div>
                      </div>
                    </div>
                  </a>
                  
                  <div class="product-actions">
                    <button class="action-btn wishlist-btn" onclick="addToWishlist('<%= product._id %>', this)" title="Add to Wishlist">
                      <i class="fas fa-heart"></i>
                    </button>
                    <button class="action-btn cart-btn" onclick="addToCart('<%= product._id %>', this)" title="Add to Cart">
                      <i class="fas fa-shopping-cart"></i>
                    </button>
                  </div>
                </div>
                
                <div class="product-info">
                  <a href="/shop/<%= product._id %>" class="product-link">
                    <h3 class="product-name"><%= product.productName %></h3>
                  </a>
                  
                  <div class="product-price">
                    <% if (variant) { %>
                      <% if (variant.appliedOffer>0) { %>
                        <span class="current-price">₹<%= variant.finalPrice.toFixed(2) %></span>
                        <span class="original-price">₹<%= variant.salesPrice.toFixed(2) %></span>
                        <span class="discount-percent">
                          <%= variant.appliedOffer %>% OFF
                        </span>
                      <% } else if (variant.salesPrice) { %>
                        <span class="current-price">₹<%= variant.salesPrice.toFixed(2) %></span>
                      <% } else { %>
                        <span class="current-price">₹0.00</span>
                      <% } %>
                    <% } else { %>
                      <span class="current-price">₹0.00</span>
                    <% } %>
                  </div>
                  
                  <div class="product-rating">
                    <div class="stars">
                      <i class="fas fa-star"></i>
                      <i class="fas fa-star"></i>
                      <i class="fas fa-star"></i>
                      <i class="fas fa-star"></i>
                      <i class="far fa-star"></i>
                    </div>
                    <span class="rating-text">(4.0)</span>
                  </div>
                </div>
              </div>
            <% }); %>
          <% } %>
        </div>

        <!-- Pagination -->
        <% if (totalPages > 1) { %>
          <div class="pagination-container animate-fade-in-up">
            <div class="pagination-info">
              <span>Showing <%= ((currentPage - 1) * productsPerPage) + 1 %> - <%= Math.min(currentPage * productsPerPage, totalProducts) %> of <%= totalProducts %> products</span>
            </div>
            
            <nav class="pagination" aria-label="Product pagination">
              <!-- Previous Button -->
              <% if (currentPage > 1) { %>
                <a href="<%= buildPaginationUrl(currentPage - 1) %>" class="pagination-btn pagination-prev" aria-label="Previous page">
                  <i class="fas fa-chevron-left"></i>
                  <span>Previous</span>
                </a>
              <% } else { %>
                <span class="pagination-btn pagination-prev disabled" aria-label="Previous page">
                  <i class="fas fa-chevron-left"></i>
                  <span>Previous</span>
                </span>
              <% } %>

              <!-- Page Numbers -->
              <div class="pagination-numbers">
                <% 
                  let startPage = Math.max(1, currentPage - 2);
                  let endPage = Math.min(totalPages, currentPage + 2);
                  
                  // Adjust if we're near the beginning or end
                  if (currentPage <= 3) {
                    endPage = Math.min(5, totalPages);
                  }
                  if (currentPage > totalPages - 3) {
                    startPage = Math.max(1, totalPages - 4);
                  }
                %>

                <!-- First page if not in range -->
                <% if (startPage > 1) { %>
                  <a href="<%= buildPaginationUrl(1) %>" class="pagination-number">1</a>
                  <% if (startPage > 2) { %>
                    <span class="pagination-ellipsis">...</span>
                  <% } %>
                <% } %>

                <!-- Page numbers in range -->
                <% for (let i = startPage; i <= endPage; i++) { %>
                  <% if (i === currentPage) { %>
                    <span class="pagination-number active" aria-current="page"><%= i %></span>
                  <% } else { %>
                    <a href="<%= buildPaginationUrl(i) %>" class="pagination-number"><%= i %></a>
                  <% } %>
                <% } %>

                <!-- Last page if not in range -->
                <% if (endPage < totalPages) { %>
                  <% if (endPage < totalPages - 1) { %>
                    <span class="pagination-ellipsis">...</span>
                  <% } %>
                  <a href="<%= buildPaginationUrl(totalPages) %>" class="pagination-number"><%= totalPages %></a>
                <% } %>
              </div>

              <!-- Next Button -->
              <% if (currentPage < totalPages) { %>
                <a href="<%= buildPaginationUrl(currentPage + 1) %>" class="pagination-btn pagination-next" aria-label="Next page">
                  <span>Next</span>
                  <i class="fas fa-chevron-right"></i>
                </a>
              <% } else { %>
                <span class="pagination-btn pagination-next disabled" aria-label="Next page">
                  <span>Next</span>
                  <i class="fas fa-chevron-right"></i>
                </span>
              <% } %>
            </nav>

          </div>
        <% } %>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="site-footer animate-fade-in-up">
    <div class="container">
      <div class="footer-content">
        <div class="footer-column">
          <h3>Store Location</h3>
          <address>
            <p>500 Terry Francine Street</p>
            <p>San Francisco, CA 94158</p>
            <p>info@shadelectro.com</p>
            <p>123-456-7890</p>
          </address>
          <div class="social-links">
            <a href="#" class="social-link"><i class="fab fa-facebook-f"></i></a>
            <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
            <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
            <a href="#" class="social-link"><i class="fab fa-youtube"></i></a>
          </div>
        </div>
        
        <div class="footer-column">
          <h3>Quick Links</h3>
          <ul>
            <li><a href="/shop">Shop All</a></li>
            <li><a href="/about">About Us</a></li>
            <li><a href="/contact">Contact</a></li>
            <li><a href="/deals-Offers">Deals & Offers</a></li>
          </ul>
        </div>
        
        <div class="footer-column">
          <h3>Customer Support</h3>
          <ul>
            <li><a href="/contact">Contact Us</a></li>
            <li><a href="/help">Help Center</a></li>
            <li><a href="/shipping">Shipping Info</a></li>
            <li><a href="/returns">Returns</a></li>
          </ul>
        </div>
        
        <div class="footer-column">
          <h3>Newsletter</h3>
          <p>Subscribe to get updates on new products and offers</p>
          <form class="newsletter-form">
            <input type="email" placeholder="Enter your email" required>
            <button type="submit">
              <i class="fas fa-paper-plane"></i>
            </button>
          </form>
        </div>
      </div>
      
      <div class="copyright">
        <p>&copy; 2025 ShadElectro. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- Back to Top Button -->
  <button class="back-to-top" id="backToTop" onclick="scrollToTop()">
    <i class="fas fa-arrow-up"></i>
  </button>

  <!-- Success Toast -->
  <div class="toast" id="successToast">
    <div class="toast-content">
      <i class="fas fa-check-circle"></i>
      <span class="toast-message">Item added successfully!</span>
    </div>
  </div>

  <script>
    let user = <%- JSON.stringify(user) %>;
    
    // Intersection Observer for animations
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('animate-visible');
        }
      });
    }, observerOptions);

    // Observe all animated elements
    document.addEventListener('DOMContentLoaded', function() {
      const animatedElements = document.querySelectorAll('[class*="animate-"]');
      animatedElements.forEach(el => observer.observe(el));
    });

    // Dropdown functionality
    document.addEventListener("DOMContentLoaded", () => {
      const dropdown = document.querySelector(".dropdown");
      const accountLink = document.querySelector(".account-link");

      if (accountLink) {
        accountLink.addEventListener("click", (e) => {
          e.preventDefault();
          dropdown.classList.toggle("show");
        });

        // Hide dropdown when clicking outside
        document.addEventListener("click", (e) => {
          if (!dropdown.contains(e.target)) {
            dropdown.classList.remove("show");
          }
        });
      }
    });
    
    // Handle price range slider
    const priceSlider = document.getElementById('price-slider');
    const priceRangeInput = document.getElementById('price-range-input');
    const dynamicPrice = document.getElementById('dynamic-price');
    const sliderFill = document.querySelector('.slider-fill');
    
    if (priceSlider) {
      // Update slider fill on load
      updateSliderFill();
      
      priceSlider.addEventListener('input', function() {
        const value = this.value;
        dynamicPrice.textContent = `₹${value}`;
        priceRangeInput.value = `100-${value}`;
        updateSliderFill();
      });
      
      priceSlider.addEventListener('change', function() {
        // Auto-submit after a delay
        setTimeout(() => {
          document.getElementById('filter-form').submit();
        }, 500);
      });
    }
    
    function updateSliderFill() {
      const slider = document.getElementById('price-slider');
      const fill = document.querySelector('.slider-fill');
      if (slider && fill) {
        const percentage = ((slider.value - slider.min) / (slider.max - slider.min)) * 100;
        fill.style.width = percentage + '%';
      }
    }
    
    // Handle sort selection
    function updateSort(sortValue) {
      const url = new URL(window.location.href);
      url.searchParams.set('sort', sortValue);
      url.searchParams.set('page', '1'); // Reset to first page when sorting
      
      // Add loading effect
      const sortSelect = document.getElementById('sort-select');
      sortSelect.style.opacity = '0.5';
      
      window.location.href = url.toString();
    }
    

    
    // Toggle sidebar sections
    function toggleSection(icon) {
      const section = icon.closest('.sidebar-section');
      const content = section.querySelector('.price-range');
      const iconElement = icon.querySelector('i');
      
      if (content.style.display === 'none') {
        content.style.display = 'block';
        iconElement.className = 'fas fa-minus';
        content.style.animation = 'slideDown 0.3s ease';
      } else {
        content.style.animation = 'slideUp 0.3s ease';
        setTimeout(() => {
          content.style.display = 'none';
        }, 300);
        iconElement.className = 'fas fa-plus';
      }
    }

    // Back to top functionality
    window.addEventListener('scroll', function() {
      const backToTop = document.getElementById('backToTop');
      if (window.pageYOffset > 300) {
        backToTop.classList.add('visible');
      } else {
        backToTop.classList.remove('visible');
      }
    });

    function scrollToTop() {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    }

    // Add to cart functionality
    async function addToCart(productId, button) {
      if(!user){
        return showToast("Please Login!",'error')
      }
      try {
        const variantIndex = 0;
        const quantity = 1;

        const res = await fetch('/cart', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ productId, variantIndex, quantity })
        });

        const data = await res.json();

        if (data.success) {
          button.classList.add('success');
          button.innerHTML = '<i class="fas fa-check"></i>';

          showToast("Item added to cart!");

          setTimeout(() => {
            button.classList.remove('success');
            button.innerHTML = '<i class="fas fa-shopping-cart"></i>';
          }, 2000);

          // Update cart count in header
          const cartCount = document.querySelector('.cart-count');
          if (cartCount) {
            cartCount.textContent = parseInt(cartCount.textContent) + 1;
          }
        } else {
          showToast(data.message || "Failed to add to cart");
        }
      } catch (error) {
        console.error("Error adding to cart:", error);
        showToast("Something went wrong. Try again.");
      }
    }

    // Add to wishlist functionality
    async function addToWishlist(productId, button) {
      try {
        const res = await fetch('/wishlist', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ productId })
        });

        const data = await res.json();

        if (data.success) {
          button.classList.add('success');
          const icon = button.querySelector('i');
          icon.className = 'fas fa-check';
          showToast("Added to wishlist!");

          setTimeout(() => {
            button.classList.remove('success');
            icon.className = 'fas fa-heart';
          }, 2000);
        } else {
          showToast(data.message || "Already in wishlist");
        }
      } catch (error) {
        console.error("Error adding to wishlist:", error);
        showToast("Failed to add to wishlist");
      }
    }

    // Toast notification
    function showToast(message, type = 'success') {
      const toast = document.getElementById('successToast');
      const messageElement = toast.querySelector('.toast-message');
      
      messageElement.textContent = message;
      toast.classList.add('show');
      
      // Add error styling if needed
      if (type === 'error') {
        toast.classList.add('error');
      } else {
        toast.classList.remove('error');
      }
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }

    // Search input focus effect
    const searchInput = document.querySelector('.search-input');
    if (searchInput) {
      searchInput.addEventListener('focus', function() {
        this.parentElement.classList.add('focused');
      });
      
      searchInput.addEventListener('blur', function() {
        this.parentElement.classList.remove('focused');
      });
    }

    // Product card hover effects
    document.querySelectorAll('.product-card').forEach(card => {
      card.addEventListener('mouseenter', function() {
        this.style.transform = 'translateY(-10px) scale(1.02)';
      });
      
      card.addEventListener('mouseleave', function() {
        this.style.transform = 'translateY(0) scale(1)';
      });
    });

    // Pagination animations
    document.addEventListener('DOMContentLoaded', function() {
      const paginationNumbers = document.querySelectorAll('.pagination-number');
      paginationNumbers.forEach((number, index) => {
        number.style.animationDelay = `${index * 0.05}s`;
      });
    });
  </script>

  <style>
    /* Pagination Styles */
    .pagination-container {
      margin-top: 3rem;
      padding: 2rem 0;
      border-top: 1px solid #e5e7eb;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      align-items: center;
    }

    .pagination-info {
      color: #6b7280;
      font-size: 0.875rem;
      text-align: center;
    }

    .pagination {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: wrap;
      justify-content: center;
    }

    .pagination-btn {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1rem;
      background: white;
      border: 1px solid #d1d5db;
      border-radius: 0.5rem;
      color: #374151;
      text-decoration: none;
      font-weight: 500;
      transition: all 0.2s ease;
      min-width: 100px;
      justify-content: center;
    }

    .pagination-btn:hover:not(.disabled) {
      background: #f3f4f6;
      border-color: #9ca3af;
      transform: translateY(-1px);
    }

    .pagination-btn.disabled {
      opacity: 0.5;
      cursor: not-allowed;
      pointer-events: none;
    }

    .pagination-numbers {
      display: flex;
      align-items: center;
      gap: 0.25rem;
      flex-wrap: wrap;
    }

    .pagination-number {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 2.5rem;
      height: 2.5rem;
      background: white;
      border: 1px solid #d1d5db;
      border-radius: 0.5rem;
      color: #374151;
      text-decoration: none;
      font-weight: 500;
      transition: all 0.2s ease;
      animation: fadeInUp 0.3s ease forwards;
      opacity: 0;
      transform: translateY(10px);
    }

    .pagination-number:hover {
      background: #f3f4f6;
      border-color: #9ca3af;
      transform: translateY(-1px);
    }

    .pagination-number.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-color: #667eea;
      color: white;
      transform: scale(1.1);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }

    .pagination-ellipsis {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 2.5rem;
      height: 2.5rem;
      color: #9ca3af;
      font-weight: bold;
    }

    .items-per-page {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.875rem;
      color: #6b7280;
    }

    .items-per-page select {
      padding: 0.5rem;
      border: 1px solid #d1d5db;
      border-radius: 0.375rem;
      background: white;
      color: #374151;
      font-size: 0.875rem;
    }

    .items-per-page select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    /* Page info in header */
    .page-info {
      color: #9ca3af;
      font-size: 0.875rem;
      margin-left: 0.5rem;
    }

    /* Toast error styling */
    .toast.error .toast-content {
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
    }

    /* Responsive pagination */
    @media (max-width: 768px) {
      .pagination-container {
        margin-top: 2rem;
        padding: 1.5rem 0;
        gap: 1rem;
      }

      .pagination {
        gap: 0.25rem;
      }

      .pagination-btn {
        padding: 0.5rem 0.75rem;
        min-width: 80px;
        font-size: 0.875rem;
      }

      .pagination-number {
        width: 2rem;
        height: 2rem;
        font-size: 0.875rem;
      }

      .items-per-page {
        flex-direction: column;
        text-align: center;
        gap: 0.25rem;
      }
    }

    /* Animation keyframes */
    @keyframes fadeInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Loading states */
    .pagination-loading {
      opacity: 0.6;
      pointer-events: none;
    }

    .pagination-loading::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 20px;
      height: 20px;
      margin: -10px 0 0 -10px;
      border: 2px solid #f3f3f3;
      border-top: 2px solid #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</body>
</html>
